**Segmentation Approaches Comparison:**

| Aspect / Step         | **Basic** (`dino_segmentation_basic.ipynb`)                             | **Heuristic** (`dino_segmentation_heuristic.ipynb`)         | **Advanced U2Seg** (`dino_segmentation_advanced_u2seg.ipynb`)                                | Main difference              |
| --------------------- | ----------------------------------------------------------------------- | ----------------------------------------------------------- | -------------------------------------------------------------------------------------------- | ---------------------------- |
| Goal                  | Unsupervised silkworm **semantic + instance** segmentation              | Same goal, but **auto-detects classes by color**            | Unified **two-branch** unsupervised segmentation (instances + semantics) then merges         | More automation & modularity |
| Feature extractor     | DINOv2 ViT-B/14 via `torch.hub`                                         | Same                                                        | Same                                                                                         | —                            |
| Input resize          | 518×518                                                                 | 518×518                                                     | 518×518                                                                                      | —                            |
| Patch grid            | 37×37 tokens                                                            | 37×37                                                       | 37×37                                                                                        | —                            |
| Semantic clustering   | Spectral clustering (τ=0.12) → KMeans (k=3)                             | Same                                                        | Same                                                                                         | Same algo                    |
| Class naming          | **Hard-coded** cluster 0 = worms                                        | **HSV heuristic** (low saturation = worms, hue≈60 = leaves) | Same HSV heuristic                                                                           | Manual → automatic           |
| Instance trigger      | Only on worm mask                                                       | Same                                                        | Build many class-agnostic instances first, then label                                        | U2Seg splits first           |
| Instance split        | Distance transform + watershed on worm mask                             | Same                                                        | Same watershed **after** instance clustering                                                 | Extra step in U2Seg          |
| Pre-grouped instances | ✗                                                                       | ✗                                                           | ✓ \~150 spectral clusters (raw instances)                                                    | New in U2Seg                 |
| Min object size       | 150 px                                                                  | 150 px                                                      | 100 px (default)                                                                             | Small tweak                  |
| `min_distance`        | 12 px                                                                   | 12 px                                                       | 12 px                                                                                        | —                            |
| Semantic classes      | 3                                                                       | 3                                                           | 3                                                                                            | —                            |
| Instance clusters     | N/A                                                                     | N/A                                                         | \~150 (configurable)                                                                         | Only U2Seg                   |
| Merge rule            | N/A (only worms instanced)                                              | N/A                                                         | Majority-overlap vote instance ↔ semantic                                                    | New in U2Seg                 |
| Visual panels         | 3: Original / Semantic / Instance                                       | 3: Original / Semantic / Instance                           | 4: Original / Raw inst. / Semantic / Final merged                                            | Extra panel in U2Seg         |
| Output dict           | `instance_masks`, `semantic_map`, `label_to_name_map`, `silkworm_count` | Same, names auto-derived                                    | `raw_instances`, `classified_instances`, `category_counts`, `semantic_map`, `semantic_names` | Richer outputs               |
| Folders               | Not emphasized                                                          | Created at start                                            | Created                                                                                      | Minor                        |
| Saving                | Plots only                                                              | Plots only                                                  | Paths prepared (still plots)                                                                 | Ready to save                |
| Hyper-params exposed  | Few (τ, n\_classes, min\_obj\_size, …)                                  | Same + HSV thresholds implicit                              | More (separate τ / k for inst. vs sem.)                                                      | Finer control                |
| Naming robustness     | Fragile (ID swap)                                                       | More robust (color rules)                                   | Color rules + instance vote                                                                  | Increasing robustness        |
| Pipeline name         | —                                                                       | —                                                           | `U2SegUnified`                                                                               | Formalized class             |
| Code org              | Straightforward classes                                                 | Same + labeling fn                                          | Specialized classes + merger                                                                 | More modular                 |
| Compute cost          | Moderate                                                                | Moderate                                                    | Slightly higher (extra clustering)                                                           | Extra spectral step          |
| Worm counting         | After worm-mask watershed                                               | After worm-mask watershed                                   | After merge → per-class counts                                                               | U2Seg can count any class    |


**Classification On Seg Masks Approaches Comparison:**
